<!-- MDAnalysis -->
<div id="mdanalysis-container" class="container" style="display: none;">
    <div class="controls">
        <form id="mdanalysis-form" enctype="multipart/form-data">
            <div class="form-group">
                <label>Upload PDB File:</label>
                <input type="file" id="mdanalysis-file" name="file" accept=".pdb" required>
            </div>
            <button type="submit">Analyze Structure</button>
        </form>
        <div id="mdanalysis-results" style="margin-top: 20px; white-space: pre-wrap;"></div>
    </div>
    <div id="mdanalysis-plot" class="plot"></div>
</div>

<script>
document.getElementById('mdanalysis-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData();
    const fileInput = document.getElementById('mdanalysis-file');
    formData.append('file', fileInput.files[0]);

    try {
        const response = await fetch('/mdanalysis', {
            method: 'POST',
            body: formData
        });

        const result = await response.json();
        
        if (result.error) {
            document.getElementById('mdanalysis-results').innerHTML = `Error: ${result.error}`;
            return;
        }

        // Display the analysis results
        document.getElementById('mdanalysis-results').innerHTML = result.results;
        
        // Clear the file input
        fileInput.value = '';
        
    } catch (error) {
        console.error('Error in MDAnalysis:', error);
        document.getElementById('mdanalysis-results').innerHTML = `Error: ${error.message}`;
    }
});
</script> 