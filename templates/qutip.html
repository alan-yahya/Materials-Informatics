<!-- QuTiP Simulation -->
<div id="qutip-container" class="container" style="display: none;">
    <div class="controls">
        <form id="qutip-form">
            <div class="form-group">
                <label>Number of Energy Levels:</label>
                <input type="number" id="n-levels" value="3" min="2" max="10" step="1">
            </div>
            <div class="form-group">
                <label>Decay Rate (γ):</label>
                <input type="number" id="gamma" value="0.1" min="0.01" max="1.0" step="0.01">
            </div>
            <div class="form-group">
                <label>Rabi Frequency (Ω):</label>
                <input type="number" id="omega" value="1.0" min="0.1" max="5.0" step="0.1">
            </div>
            <div class="form-group">
                <label>Simulation Time:</label>
                <input type="number" id="t-max" value="10.0" min="1.0" max="50.0" step="1.0">
            </div>
            <div class="form-group">
                <label>Time Steps:</label>
                <input type="number" id="n-steps" value="200" min="50" max="1000" step="50">
            </div>
            <button type="submit">Run QuTiP Simulation</button>
        </form>
    </div>
    <div id="qutip-plot" class="plot"></div>
</div>

<script>
document.getElementById('qutip-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const data = {
        n_levels: parseInt(document.getElementById('n-levels').value),
        gamma: parseFloat(document.getElementById('gamma').value),
        omega: parseFloat(document.getElementById('omega').value),
        t_max: parseFloat(document.getElementById('t-max').value),
        n_steps: parseInt(document.getElementById('n-steps').value)
    };

    const response = await fetch('/qutip', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
    });

    const result = await response.json();
    if (result.error) {
        console.error('QuTiP simulation error:', result.error);
        return;
    }
    const plotData = JSON.parse(result.plot);
    Plotly.newPlot('qutip-plot', plotData.data, plotData.layout);
});
</script> 